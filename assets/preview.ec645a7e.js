var e=Object.defineProperty,o=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,r=(o,t,n)=>t in o?e(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n;import{e as s,f as i,h as c,P as u,j as p,I as d,L as m,k as f,l as v,w as y,m as g,v as b}from"./visual.config.e3efb3ce.js";import{k as O,a as h,v as C,d as k,w,t as S,n as j,z as P,G as x,l as z,q as N,f as T,o as A,b as B,ag as E,aB as I,e as _,F as D,C as L,Y as M}from"./preload-helper.b9d3c5f4.js";import{r as K}from"./preview.50c15cbe.js";var R=0;var[G,U]=p("toast"),Y=k({name:G,props:{icon:String,show:Boolean,overlay:Boolean,message:[Number,String],iconSize:[Number,String],className:c,iconPrefix:String,loadingType:String,forbidClick:Boolean,overlayClass:c,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,type:{type:String,default:"text"},duration:{type:Number,default:2e3},position:{type:String,default:"middle"},transition:{type:String,default:"van-fade"}},emits:["update:show"],setup(e,{emit:o}){var t,n=!1,a=()=>{var o=e.show&&e.forbidClick;n!==o&&((n=o)?(R||document.body.classList.add("van-toast--unclickable"),R++):R&&(--R||document.body.classList.remove("van-toast--unclickable")))},l=e=>o("update:show",e),r=()=>{e.closeOnClick&&l(!1)},s=()=>{clearTimeout(t)},i=()=>{var{icon:o,type:t,iconSize:n,iconPrefix:a,loadingType:l}=e;return o||"success"===t||"fail"===t?P(d,{name:o||t,size:n,class:U("icon"),classPrefix:a},null):"loading"===t?P(m,{class:U("loading"),size:n,type:l},null):void 0},c=()=>{var{type:o,message:t}=e;if(f(t)&&""!==t)return"html"===o?P("div",{class:U("text"),innerHTML:String(t)},null):P("div",{class:U("text")},[t])};return w((()=>[e.show,e.forbidClick]),a),w((()=>[e.show,e.type,e.message,e.duration]),(()=>{s(),e.show&&e.duration>0&&(t=setTimeout((()=>{l(!1)}),e.duration))})),S(a),j(a),()=>P(u,x({show:e.show,class:[U([e.position,{[e.type]:!e.icon}]),e.className],overlay:e.overlay,lockScroll:!1,transition:e.transition,overlayClass:e.overlayClass,overlayStyle:e.overlayStyle,closeOnClickOverlay:e.closeOnClickOverlay,onClick:r,onClosed:s},{"onUpdate:show":l}),{default:()=>[i(),c()]})}}),q={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1},F=[],H=!1,J=s({},q),$={};function Q(e){return g(e)?e:{message:e}}function V(){var e,o,{instance:t,unmount:n}=(e=O({setup(){var e=z(""),{open:o,state:a,close:l,toggle:r}=function(){var e=h({show:!1}),o=o=>{e.show=o},t=t=>{s(e,t),C((()=>o(!0)))},n=()=>o(!1);return i({open:t,close:n,toggle:o}),{open:t,close:n,state:e,toggle:o}}(),c=()=>{H&&(F=F.filter((e=>e!==t)),n())};return N().render=()=>{var o={onClosed:c,"onUpdate:show":r};return e.value&&(o.message=e.value),P(Y,x(a,o),null)},{open:o,clear:l,message:e}}}),o=document.createElement("div"),document.body.appendChild(o),{instance:e.mount(o),unmount(){e.unmount(),document.body.removeChild(o)}});return t}function W(e={}){if(!v)return{};var o=function(){if(!F.length||H){var e=V();F.push(e)}return F[F.length-1]}(),t=Q(e);return o.open(s({},J,$[t.type||J.type],t)),o}var X=e=>o=>W(s({type:e},Q(o)));W.loading=X("loading"),W.success=X("success"),W.fail=X("fail"),W.clear=e=>{F.length&&(e?(F.forEach((e=>{e.clear()})),F=[]):H?F.shift().clear():F[0].clear())},W.setDefaultOptions=function(e,o){"string"==typeof e?$[e]=o:s(J,e)},W.resetDefaultOptions=e=>{"string"==typeof e?$[e]=null:(J=s({},q),$={})},W.allowMultiple=(e=!0)=>{H=e},W.install=e=>{e.use(y(Y)),e.config.globalProperties.$toast=W};var Z={name:"SlotItem",components:{CompRender:k({name:"CompRender",props:{element:{type:Object,default:()=>({})},config:{type:Object,default:()=>({})}},setup:e=>()=>e.config.componentMap[e.element.componentKey].render({size:{},props:e.element.props||{},model:{},block:e.element,custom:{}})})},props:{element:{type:[Object,Array],default:()=>({})},config:{type:Object,default:()=>({})}}};Z.render=function(e,o,t,n,a,l){var r;const s=T("slot-item",!0),i=T("comp-render");return A(),B("div",null,[P(i,{element:t.element,config:t.config},E({_:2},[I(null==(r=t.element.props)?void 0:r.slots,((e,o)=>({name:o,fn:_((()=>[(A(!0),B(D,null,I(null==e?void 0:e.children,(e=>(A(),B(s,{key:e._vid,element:e,config:t.config},null,8,["element","config"])))),128))]))})))]),1032,["element","config"])])};var ee=k({name:"Preview",components:{SlotItem:Z},setup(){var e;const s=JSON.parse(localStorage.getItem(L.PAGE_DATA_KEY));s&&Object.keys(s.pages)||W.fail("当前没有可以预览的页面！");const i=K.currentRoute,c=h({currentPage:null==(e=s.pages[i.value.path])?void 0:e.blocks});c.currentPage||K.replace("/");const u=e=>{if(Array.isArray(e))return e.map((e=>u(e)));return b.componentMap[e.componentKey].render({size:{},props:e.props||{},block:e,model:{},custom:{}})};return p=((e,o)=>{for(var t in o||(o={}))a.call(o,t)&&r(e,t,o[t]);if(n)for(var t of n(o))l.call(o,t)&&r(e,t,o[t]);return e})({},M(c)),o(p,t({visualConfig:b,renderCom:u}));var p}});ee.render=function(e,o,t,n,a,l){const r=T("slot-item");return A(!0),B(D,null,I(e.currentPage,(o=>(A(),B(r,{key:o._vid,element:o,config:e.visualConfig},null,8,["element","config"])))),128)};export default ee;
