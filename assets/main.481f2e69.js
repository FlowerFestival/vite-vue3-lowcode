var e=Object.defineProperty,o=Object.prototype.hasOwnProperty,t=Object.getOwnPropertySymbols,l=Object.prototype.propertyIsEnumerable,n=(o,t,l)=>t in o?e(o,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):o[t]=l,a=(e,a)=>{for(var s in a||(a={}))o.call(a,s)&&n(e,s,a[s]);if(t)for(var s of t(a))l.call(a,s)&&n(e,s,a[s]);return e};import"./index.124f267a.js";import{d as s,r as i,u as r,l as c,w as d,t as u,o as p,c as m,a as g,b as f,_ as v,p as b,e as h,f as k,g as y,F as _,h as C,i as w,j as V,k as j,m as O,n as D,q as S,s as x,v as P,x as U,y as M,z as B,A as E,B as N,C as I,D as $,E as A,G as F,H as R,I as q,J as T,K as W,L,M as z,N as G,O as H,P as J,Q as K,R as X,S as Y,W as Q,T as Z,U as ee,V as oe,X as te,Y as le,Z as ne,$ as ae,a0 as se,a1 as ie,a2 as re,a3 as ce,a4 as de,a5 as ue,a6 as pe,a7 as me,a8 as ge,a9 as fe,aa as ve,ab as be,ac as he,ad as ke,ae as ye,af as _e,ag as Ce,ah as we,ai as Ve,aj as je,ak as Oe}from"./json.worker.facf0d2f.js";import{v as De,c as Se,V as xe,u as Pe,a as Ue}from"./visual.config.453702f9.js";var Me=s({name:"Preview",props:{visible:{type:Boolean,default:!1}},emits:["update:visible"],setup(e,{emit:o}){const t=i({dialogVisible:r(e,"visible",o),jsonDataClone:c.cloneDeep(e.jsonData)});d((()=>t.dialogVisible),(o=>{o&&(t.jsonDataClone=c.cloneDeep(e.jsonData))}));const l=o=>{if(Array.isArray(o))return o.map((e=>l(e)));return e.config.componentMap[o.componentKey].render({size:{},props:o.props||{},block:o,model:{},custom:{}})};return a(a({},u(t)),{BASE_URL:"/vite-vue3-lowcode/",renderCom:l})}});Me.render=function(e,o){const t=v;return p(),m(t,{modelValue:e.dialogVisible,"onUpdate:modelValue":o[1]||(o[1]=o=>e.dialogVisible=o),"custom-class":"h5-preview","show-close":!1,width:"360px"},{default:g((()=>[f("iframe",{style:{width:"360px",height:"640px"},src:`${e.BASE_URL}preview/#/`,frameborder:"0",scrolling:"auto"},null,8,["src"])])),_:1},8,["modelValue"])};var Be=s({name:"Header",components:{Preview:Me},props:{jsonData:{type:Object,default:()=>({})}},setup(e){const o=i({isShowH5Preview:!1});return a(a({},u(o)),{runPreview:()=>{sessionStorage.setItem("blocks",JSON.stringify(e.jsonData.blocks)),o.isShowH5Preview=!0}})}});const Ee=C();b("data-v-ad1def40");const Ne=f("div",{class:"logo"},null,-1),Ie=f("h3",{class:"font-semibold"},"H5低代码",-1),$e=f("div",null,null,-1);h();const Ae=Ee(((e,o,t,l,n,a)=>{const s=w,i=V,r=j,c=O,d=k("preview");return p(),m(_,null,[f(c,{type:"flex",class:"header"},{default:Ee((()=>[f(s,{span:6,class:"flex items-center"},{default:Ee((()=>[Ne,Ie])),_:1}),f(s,{span:12},{default:Ee((()=>[$e])),_:1}),f(s,{span:6,class:"flex flex-row-reverse items-center"},{default:Ee((()=>[f(r,{class:"item",effect:"dark",content:"运行",placement:"bottom"},{default:Ee((()=>[f(i,{type:"primary",icon:"el-icon-video-play",circle:"",class:"flex-shrink-0",onClick:e.runPreview},null,8,["onClick"])])),_:1})])),_:1})])),_:1}),e.isShowH5Preview?(p(),m(d,{key:0,visible:e.isShowH5Preview,"onUpdate:visible":o[1]||(o[1]=o=>e.isShowH5Preview=o)},null,8,["visible"])):y("",!0)],64)}));Be.render=Ae,Be.__scopeId="data-v-ad1def40";const Fe=[{name:"pages",icon:"el-icon-tickets",label:"页面",componentName:"PageTree"},{name:"base-widget",icon:"el-icon-edit",label:"基础控件",componentName:"BaseWidgets"},{name:"complex-component",icon:"el-icon-suitcase",label:"容器组件",componentName:"ContainerComponent"},{name:"custom-component",icon:"el-icon-upload",label:"自定义组件",componentName:"custom-component"}];var Re={"list-group-item":"_list-group-item_1kgpy_1",listGroupItem:"_list-group-item_1kgpy_1"},qe=s({name:"BaseWidgets",setup(){const e=e=>{window.console.log(e)},o=e=>{console.log("当前拖拽的组件：",e);const o=c.cloneDeep(e);return o._vid=Date.now(),Se({left:0,top:0,component:o})};return()=>f(_,null,[f(D,{class:Re.listGroup,sort:!1,forceFallback:!1,list:De.componentModules.baseWidgets,group:{name:"components",pull:"clone",put:!1},clone:o,"item-key":"key",onChange:e},{item:({element:e})=>f("div",{class:Re.listGroupItem,"data-label":e.label},[e.preview()])})])}}),Te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:qe});var We={"list-group-item":"_list-group-item_1kgpy_1",listGroupItem:"_list-group-item_1kgpy_1"},Le=s({name:"ContainerComponent",setup(){const e=e=>{window.console.log(e)},o=e=>{console.log("当前拖拽的组件：",e);const o=c.cloneDeep(e);return o._vid=Date.now(),Se({left:0,top:0,component:o})};return()=>f(_,null,[f(D,{class:We.listGroup,sort:!1,forceFallback:!1,list:De.componentModules.containerComponents,group:{name:"components",pull:"clone",put:!1},clone:o,"item-key":"key",onChange:e},{item:({element:e})=>f("div",{class:We.listGroupItem,"data-label":e.label},[e.preview()])})])}}),ze=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Le});const Ge={name:"CustomComponent"};Ge.render=function(e,o,t,l,n,a){return"自定义组件"};var He=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ge});const Je=[{label:"一级 1",children:[{label:"二级 1-1",children:[{label:"三级 1-1-1"}]}]},{label:"一级 2",children:[{label:"二级 2-1",children:[{label:"三级 2-1-1"}]},{label:"二级 2-2",children:[{label:"三级 2-2-1"}]}]},{label:"一级 3",children:[{label:"二级 3-1",children:[{label:"三级 3-1-1"}]},{label:"二级 3-2",children:[{label:"三级 3-2-1"}]}]}];var Ke=s({name:"PageTree",setup(){const e=i({data:Je,defaultProps:{children:"children",label:"label"}});return a(a({},u(e)),{handleNodeClick:e=>{console.log(e)},addPage:e=>{console.log("子页面数据：",e)},delPage:e=>{console.log("删除子页面数据",e)}})}});const Xe=C();b("data-v-27a162eb");const Ye={class:"custom-tree-node"},Qe=f("span",{class:"el-dropdown-link"},[f("i",{class:"el-icon-more"})],-1),Ze=P("添加子页面"),eo=P("删除");h();const oo=Xe(((e,o,t,l,n,a)=>{const s=U,i=M,r=B,c=E;return p(),m(c,{data:e.data,props:e.defaultProps,onNodeClick:e.handleNodeClick},{default:Xe((({node:t,data:l})=>[f("span",Ye,[f("span",null,S(t.label),1),f("span",{onClick:o[1]||(o[1]=x((()=>{}),["stop"]))},[f(r,{trigger:"click"},{dropdown:Xe((()=>[f(i,null,{default:Xe((()=>[f(s,{icon:"el-icon-plus",onClick:o=>e.addPage(l)},{default:Xe((()=>[Ze])),_:2},1032,["onClick"]),f(s,{icon:"el-icon-delete",onClick:o=>e.delPage(l)},{default:Xe((()=>[eo])),_:2},1032,["onClick"])])),_:2},1024)])),default:Xe((()=>[Qe])),_:2},1024)])])])),_:1},8,["data","props","onNodeClick"])}));Ke.render=oo,Ke.__scopeId="data-v-27a162eb";const to={"./base-widgets/index.tsx":Te,"./container-component/index.tsx":ze,"./custom-component/index.vue":He,"./page-tree/index.vue":Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ke})},lo={};console.log(to,"起航");for(const Yo in to){const e=to[Yo].default;lo[e.name]=e}console.log("left-aside components:",lo);var no=s({name:"LeftAside",components:lo,setup(){const e=i({activeName:Fe[0].name});return a(a({},u(e)),{tabs:Fe,handleClick:(e,o)=>{console.log(e,o)}})}});const ao=C();b("data-v-6e6b5004");const so={class:"flex flex-col items-center justify-center"};h();const io=ao(((e,o,t,l,n,a)=>{const s=A,i=I;return p(),m(i,{modelValue:e.activeName,"onUpdate:modelValue":o[1]||(o[1]=o=>e.activeName=o),"tab-position":"left",onTabClick:e.handleClick},{default:ao((()=>[(p(!0),m(_,null,N(e.tabs,(e=>(p(),m(s,{key:e.name,name:e.name},{label:ao((()=>[f("div",so,[f("i",{class:e.icon},null,2),P(" "+S(e.label),1)])])),default:ao((()=>[(p(),m($(e.componentName)))])),_:2},1032,["name"])))),128))])),_:1},8,["modelValue","onTabClick"])}));no.render=io,no.__scopeId="data-v-6e6b5004";var ro="_drawer_e36ge_9",co="_is-open_e36ge_26",uo="_floating-action-btn_e36ge_21",po="_attrs_e36ge_53";function mo(e,o){const t=q(e());return d(e,(e=>{e!==t.value&&(t.value=e)})),{get value(){return t.value},set value(e){t.value!==e&&(t.value=e,o(e))}}}s({props:{modelValue:{type:String}},emits:["update:modelValue"],setup(e,o){const t=mo((()=>e.modelValue),(e=>o.emit("update:modelValue",e)));return()=>f("div",null,[P("自定义的输入框"),F(f("input",{type:"text","onUpdate:modelValue":e=>t.value=e},null),[[R,t.value]])])}});const go=()=>{const e={};return e.promise=new Promise(((o,t)=>{e.resolve=o,e.reject=t})),e};const fo=s({props:{option:{type:Object,required:!0}},setup(e){const o=K(),t=i({option:e.option,showFlag:!1,mounted:(()=>{const e=go();return T((()=>setTimeout((()=>e.resolve()),0))),e.promise})(),editData:[]}),l={service:e=>{t.option=e,t.editData=c.cloneDeep(e.data||[]),l.show()},show:async()=>{await t.mounted,t.showFlag=!0},hide:()=>{t.showFlag=!1},add:()=>{t.editData.push({})},reset:()=>{t.editData=c.cloneDeep(t.option.data)}},n={onConfirm:()=>{t.option.onConfirm(t.editData),l.hide()},onCancel:()=>{l.hide()},onDelete:e=>{t.editData.splice(e,1)}};return Object.assign(o.proxy,l),()=>f(_,null,[f(W,{modelValue:t.showFlag},{default:()=>f("div",null,[f("div",null,[f(L,{onClick:l.add},{default:()=>[P("添加")]}),f(L,{onClick:l.reset},{default:()=>[P("重置")]})]),f(z,{data:t.editData},{default:()=>[f(G,{type:"index"},null),t.option.config.table.options.map((e=>f(G,{label:e.label},{default:({row:o})=>f(H,{modelValue:o[e.field],"onUpdate:modelValue":t=>o[e.field]=t},null)}))),f(G,{label:"操作栏"},{default:({$index:e})=>f(L,J({type:"danger"},{onClick:()=>n.onDelete(e)}),{default:()=>[P("删除")]})})]})]),footer:()=>f(_,null,[f(L,{onClick:n.onCancel},{default:()=>[P("取消")]}),f(L,J({type:"primary"},{onClick:n.onConfirm}),{default:()=>[P("确定")]})])})])}}),vo=(()=>{let e;return o=>{if(!e){const t=document.createElement("div");document.body.appendChild(t);const l=X(fo,{option:o});e=l.mount(t)}const t=go();return e.service(a(a({},o),{onConfirm:t.resolve})),t.promise}})(),bo=s({props:{modelValue:{type:Array},propConfig:{type:Object,required:!0}},emits:["update:modelValue"],setup(e,o){const t=mo((()=>e.modelValue),(e=>o.emit("update:modelValue",e))),l=async()=>{const o=await vo({config:e.propConfig,data:e.modelValue||[]});t.value=o};return()=>f("div",null,[(!t.value||0==t.value.length)&&f(L,{onClick:l},{default:()=>[P("添加")]}),(t.value||[]).map((o=>f(Y,{onClick:l},{default:()=>[o[e.propConfig.table.showKey]]})))])}});(globalThis||window).MonacoEnvironment={getWorker:(e,o)=>"json"===o?new Q:"css"===o||"scss"===o||"less"===o?new Z:void 0},ee.getLanguages();var ho="_container_z26um_9",ko="_title_z26um_16",yo="_code_z26um_21";let _o,Co=!1;var wo=s({name:"MonacoEditor",props:{code:{type:String,required:!0},vid:[String,Number],onChange:{type:Function,required:!0},title:{type:String,required:!0}},setup(e){const o=oe(null),t=q(null),l=()=>{window.requestIdleCallback((()=>{o.value.getAction("editor.action.formatDocument").run()}),{timeout:800})};T((()=>{o.value=te.create(t.value,{value:e.code,theme:"vs-dark",language:"json",formatOnPaste:!0,tabSize:2,minimap:{enabled:!1},fontFamily:"微软雅黑",overviewRulerBorder:!1,scrollBeyondLastLine:!1}),_o=o.value.onDidChangeModelContent((t=>{Co||e.onChange(o.value.getValue(),t)})),l(),o.value.layout({width:300,height:800})})),le((()=>{_o&&_o.dispose()}));return d((()=>e.vid),(()=>{if(o.value){const t=o.value,n=t.getModel();n&&e.code!==n.getValue()&&(t.pushUndoStop(),Co=!0,n.pushEditOperations([],[{range:n.getFullModelRange(),text:e.code}],(()=>null))),t.pushUndoStop(),Co=!1,l()}})),()=>f("div",{class:ho},[e.title&&f("div",{class:ko},[f("span",null,[e.title])]),f("div",{class:yo,ref:t},null)])}});function Vo(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!de(e)}var jo=s({name:"RightAttributePanel",props:{block:{type:Object,default:()=>({})},config:{type:Object,required:!0},dataModel:{type:Object,required:!0}},setup(e,{emit:o}){const t=i({activeName:"attr",isOpen:!0,editData:r(e,"block",o)}),l=(e,o)=>{const{propObj:l,prop:n}=Pe(t.editData.props,e);return{[xe.input]:()=>f(H,{modelValue:l[n],"onUpdate:modelValue":e=>l[n]=e},null),[xe.inputNumber]:()=>f(ae,{modelValue:l[n],"onUpdate:modelValue":e=>l[n]=e},null),[xe.switch]:()=>f(se,{modelValue:l[n],"onUpdate:modelValue":e=>l[n]=e},null),[xe.color]:()=>f(ie,{modelValue:l[n],"onUpdate:modelValue":e=>l[n]=e},null),[xe.select]:()=>{let e;return f(re,{modelValue:l[n],"onUpdate:modelValue":e=>l[n]=e,valueKey:"value"},Vo(e=o.options.map((e=>f(ce,{label:e.label,value:e.val},null))))?e:{default:()=>[e]})},[xe.table]:()=>f(bo,{modelValue:l[n],"onUpdate:modelValue":e=>l[n]=e,propConfig:o},null)}[o.type]()};return()=>{const o=[];if(e.block){const{componentKey:t}=e.block,n=e.config.componentMap[t];console.log("props.block:",e.block),o.push(f(ne,{label:"组件ID",labelWidth:"76px"},{default:()=>[e.block._vid,f(ue,{width:200,trigger:"hover",content:`你可以利用该组件ID。对该组件进行获取和设置其属性，组件可用属性可在控制台输入：$$refs.${e.block._vid} 进行查看`},{reference:()=>f("i",{style:{marginLeft:"6px"},class:"el-icon-warning-outline"},null)})]})),n&&n.props&&o.push(f(_,null,[Object.entries(n.props||{}).map((([e,o])=>f(ne,{key:e},{default:()=>[l(e,o)],label:()=>o.tips?f(_,null,[f(ue,{width:200,trigger:"hover",content:o.tips},{reference:()=>f("i",{class:"el-icon-warning-outline"},null)}),o.label]):o.label})))]))}else o.push(f(_,null,[f(ne,{label:"容器宽度"},{default:()=>[f(ae,J({modelValue:t.editData.width,"onUpdate:modelValue":e=>t.editData.width=e},{step:100}),null)]}),f(ne,{label:"容器高度"},{default:()=>[f(ae,J({modelValue:t.editData.height,"onUpdate:modelValue":e=>t.editData.height=e},{step:100}),null)]})]));const n=e=>{try{const o=JSON.parse(e);Object.assign(t.editData,o)}catch(o){console.log("JSON格式有误：",o)}};return f(_,null,[f("div",{class:[ro,{[co]:t.isOpen}]},[f("div",{class:uo,onClick:()=>t.isOpen=!t.isOpen},[f("i",{class:"el-icon-d-arrow-"+(t.isOpen?"right":"left")},null)]),f("div",{class:po},[f(pe,{modelValue:t.activeName,"onUpdate:modelValue":e=>t.activeName=e},{default:()=>[f(me,{label:"属性面板",name:"attr"},{default:()=>[f(ge,{size:"mini","label-position":"left"},Vo(o)?o:{default:()=>[o]})]}),f(me,{label:"JSON",name:"json",lazy:!0},{default:()=>[f(wo,{code:JSON.stringify(e.block),vid:"json"==t.activeName?e.block._vid:-1,onChange:n,title:""},null)]})]})])])])}}}),Oo=s({name:"DraggableTransitionGroup",components:{draggable:D},props:{moduleValue:{type:Array,default:()=>[]},drag:{type:Boolean,default:!1}},emits:["update:moduleValue","update:drag"],setup(e,{emit:o}){const t=i({list:r(e,"moduleValue",o),isDrag:r(e,"drag",o)}),l=fe((()=>({animation:200,group:"components",disabled:!1,ghostClass:"ghost"})));return a(a({},u(t)),{log:()=>{},dragOptions:l})}});const Do=C(),So=Do(((e,o,t,l,n,a)=>{const s=k("draggable");return p(),m(s,J({modelValue:e.list,"onUpdate:modelValue":o[1]||(o[1]=o=>e.list=o),class:["dragArea list-group",{isDrag:e.isDrag}],tag:"transition-group",group:{name:"nested-draggable"},"component-data":{tag:"div",type:"transition-group",name:e.isDrag?null:"flip-list"},"item-key":"_vid"},e.dragOptions,{onStart:o[2]||(o[2]=o=>e.isDrag=!0),onEnd:o[3]||(o[3]=o=>e.isDrag=!1),onChange:e.log}),{item:Do((o=>[f("div",null,[ve(e.$slots,"item",o,void 0,!0)])])),_:1},16,["modelValue","class","component-data","onChange"])}));Oo.render=So,Oo.__scopeId="data-v-225673ea";const xo=(()=>{const e="@@DROPDOWN_SERVICE_PROVIDER";return{provide:o=>be(e,o),inject:()=>he(e)}})(),Po=s({props:{option:{type:Object,required:!0}},setup(e){const o=K(),t=q({}),l=i({option:e.option,showFlag:!1,top:0,left:0,mounted:(()=>{const e=go();return T((()=>setTimeout((()=>e.resolve()),0))),e.promise})()}),n={show:async()=>{await l.mounted,l.showFlag=!0},hide:()=>{l.showFlag=!1}},a=fe((()=>["dropdown-service",{"dropdown-service-show":l.showFlag}])),s=fe((()=>({top:`${l.top}px`,left:`${l.left}px`})));Object.assign(o.proxy,{service:e=>{if(l.option=e,"addEventListener"in e.reference){const{top:o,left:t,height:n}=e.reference.getBoundingClientRect();l.top=o+n,l.left=t}else{const{clientX:o,clientY:t}=e.reference;l.left=o,l.top=t}n.show()}});const r=e=>{t.value.contains(e.target)||n.hide()};return T((()=>document.body.addEventListener("mousedown",r,!0))),le((()=>document.body.removeEventListener("mousedown",r,!0))),xo.provide({onClick:n.hide}),()=>f("div",{class:a.value,style:s.value,ref:t},[l.option.content()])}}),Uo=s({props:{label:{type:String},icon:{type:String}},emits:["click"],setup(e,o){const{onClick:t}=xo.inject(),l={onClick:e=>{o.emit("click",e),t()}};return()=>f("div",{class:"dropdown-option",onClick:l.onClick},[f("i",{class:e.icon},null),f("span",null,[e.label])])}}),Mo=(()=>{let e;return o=>{if(!e){const t=document.createElement("div");document.body.appendChild(t);const l=X(Po,{option:o});e=l.mount(t)}e.service(o)}})();var Bo=s({name:"CompRender",props:{element:{type:Object,default:()=>({})},config:{type:Object,default:()=>({})}},setup:e=>()=>e.config.componentMap[e.element.componentKey].render({size:{},props:e.element.props||{},model:{},block:e.element,custom:{}})}),Eo=s({name:"SlotItem",components:{CompRender:Bo,DraggableTransitionGroup:Oo},props:{slotKey:String,config:{type:Object,default:()=>({})},children:{type:Array,default:()=>[]},selectComp:{type:Function},onContextmenuBlock:{type:Function}},emits:["update:children","on-selected"],setup:(e,{emit:o})=>({drag:q(!1),slotChildren:r(e,"children",o)})});const No=C(),Io=No(((e,o,t,l,n,a)=>{var s;const i=k("SlotItem",!0),r=k("comp-render"),c=k("draggable-transition-group");return p(),m(c,{modelValue:e.slotChildren,"onUpdate:modelValue":o[1]||(o[1]=o=>e.slotChildren=o),drag:e.drag,"onUpdate:drag":o[2]||(o[2]=o=>e.drag=o),class:["inner-draggable",{slot:!(null==(s=e.slotChildren)?void 0:s.length)}],"data-slot":`插槽（${e.slotKey}）\n 拖拽组件到此处`},{item:No((({element:o})=>{var t,l;return[f("div",{class:["list-group-item inner",{focus:o.focus,focusWithChild:o.focusWithChild}],"data-label":o.label,onContextmenu:x((t=>e.onContextmenuBlock(t,o,e.slotChildren)),["stop","prevent"]),onMousedown:x((t=>e.selectComp(o)),["stop"])},[f(r,{config:e.config,element:o,style:{pointerEvents:Object.keys((null==(t=o.props)?void 0:t.slots)||{}).length?"auto":"none"}},ke({_:2},[N(null==(l=o.props)?void 0:l.slots,((o,t)=>({name:t,fn:No((()=>[f(i,{children:o.children,"onUpdate:children":e=>o.children=e,"slot-key":t,config:e.config,"on-contextmenu-block":e.onContextmenuBlock,"select-comp":e.selectComp},null,8,["children","onUpdate:children","slot-key","config","on-contextmenu-block","select-comp"])]))})))]),1032,["config","element","style"])],42,["data-label","onContextmenu","onMousedown"])]})),_:1},8,["modelValue","drag","class","data-slot"])}));Eo.render=Io,Eo.__scopeId="data-v-a3397532";var $o=s({name:"SimulatorEditor",components:{DraggableTransitionGroup:Oo,CompRender:Bo,SlotItem:Eo},props:{blocks:{type:Array,required:!0},config:{type:Object,required:!0}},emits:["update:blocks","on-selected"],setup(e,{emit:o}){const{globalProperties:t}=Ue(),l=i({compRefs:[],drag:!1,VMBlocks:r(e,"blocks",o)}),n=(e,o=[],t=[])=>{var l,a;for(let s=0;s<o.length;s++){const i=t.concat();if(i.push(o[s]),e==o[s]._vid)return i;const r=(null==(l=o[s].props)?void 0:l.slots)||{},c=Object.keys(r);for(let o=0;o<c.length;o++){const t=null==(a=r[c[o]])?void 0:a.children;if(t){const o=n(e,t,i);if(o)return o}}}},s=(e,o)=>{var t;const a=(null==(t=e.props)?void 0:t.slots)||{};Object.keys(a).length>0&&Object.keys(a).forEach((e=>{var t,i;null==(i=null==(t=a[e])?void 0:t.children)||i.forEach((e=>{var t;if(e.focusWithChild=!1,e.focus=e._vid==o,e.focus){n(o,l.VMBlocks).forEach((e=>e.focusWithChild=!0))}Object.keys((null==(t=e.props)?void 0:t.slots)||{}).length&&s(e,o)}))}))};return a(a({},u(l)),{selectComp:e=>{o("on-selected",e),l.VMBlocks.forEach((o=>{o.focus=e._vid==o._vid,o.focusWithChild=!1,s(o,e._vid),e.focusWithChild=!1}))},onContextmenuBlock:(e,o,n=l.VMBlocks)=>{Mo({reference:e,content:()=>f(_,null,[f(Uo,J({label:"复制节点",icon:"el-icon-document-copy"},{onClick:()=>{const e=n.findIndex((e=>e._vid==o._vid));if(-1!=e){const o=(e,t=-1)=>{var l;e._vid=`vid_${Date.now()+t}`;const n=(null==(l=null==e?void 0:e.props)?void 0:l.slots)||{},a=Object.keys(n);a.length&&a.forEach((e=>{var t,l;null==(l=null==(t=n[e])?void 0:t.children)||l.forEach(((e,t)=>o(e,t)))}))},t=c.cloneDeep(n[e]);o(t),n.splice(e,0,t)}}}),null),f(Uo,J({label:"删除节点",icon:"el-icon-delete"},{onClick:()=>{const e=n.findIndex((e=>e._vid==o._vid));-1!=e&&(delete t.$$refs[n[e]._vid],n.splice(e,1))}}),null)])})}})}});const Ao=C(),Fo=Ao(((e,o)=>{const t=k("slot-item"),l=k("comp-render"),n=k("draggable-transition-group");return p(),m(n,{drag:e.drag,"onUpdate:drag":o[1]||(o[1]=o=>e.drag=o),modelValue:e.VMBlocks,"onUpdate:modelValue":o[2]||(o[2]=o=>e.VMBlocks=o)},{item:Ao((({element:o})=>{var n,a;return[f("div",{class:["list-group-item",{focus:o.focus,focusWithChild:o.focusWithChild,drag:e.drag,"no-child":!Object.keys(o.props.slots||{}).length}],"data-label":o.label,onContextmenu:x((t=>e.onContextmenuBlock(t,o)),["stop","prevent"]),onMousedown:t=>e.selectComp(o)},[f(l,{config:e.config,element:o,style:{pointerEvents:Object.keys((null==(n=o.props)?void 0:n.slots)||{}).length?"auto":"none"}},ke({_:2},[N(null==(a=o.props)?void 0:a.slots,((o,l)=>({name:l,fn:Ao((()=>[f(t,{children:o.children,"onUpdate:children":e=>o.children=e,"slot-key":l,config:e.config,"on-contextmenu-block":e.onContextmenuBlock,"select-comp":e.selectComp},null,8,["children","onUpdate:children","slot-key","config","on-contextmenu-block","select-comp"])]))})))]),1032,["config","element","style"])],42,["data-label","onContextmenu","onMousedown"])]})),_:1},8,["drag","modelValue"])}));$o.render=Fo,$o.__scopeId="data-v-6d500e78";var Ro=s({name:"Simulator"});const qo=C();b("data-v-39828a84");const To={class:"simulator-container"},Wo={class:"simulator-editor"};h();const Lo=qo(((e,o)=>(p(),m("div",To,[f("div",Wo,[ve(e.$slots,"default",{},void 0,!0)])]))));Ro.render=Lo,Ro.__scopeId="data-v-39828a84";var zo=s({name:"Layout",components:{Header:Be,LeftAside:no,RightAttributePanel:jo,SimulatorEditor:$o,Simulator:Ro},props:{modelValue:{type:Object,required:!0},config:{type:Object,required:!0},formData:{type:Object,required:!0},customProps:{type:Object}},emits:["update:modelValue"],setup(e){const o=i({dataModel:r(e,"modelValue"),currentBlock:{}});return a(a({},u(o)),{onSelected:e=>{o.currentBlock=e,console.log("currentBlock:",o.currentBlock)}})}});zo.render=function(e,o,t,l,n,a){const s=k("Header"),i=ye,r=k("left-aside"),c=_e,d=k("simulator-editor"),u=k("simulator"),v=k("right-attribute-panel"),b=Ce,h=we;return p(),m(h,null,{default:g((()=>[f(i,{height:"80px",class:"flex items-center shadow-md"},{default:g((()=>[f(s,{"json-data":e.modelValue,config:e.config},null,8,["json-data","config"])])),_:1}),f(h,{class:"layout-container"},{default:g((()=>[f(c,{class:"shadow-sm",width:"350px"},{default:g((()=>[f(r)])),_:1}),f(b,null,{default:g((()=>[f(u,null,{default:g((()=>[f(d,{blocks:e.dataModel.blocks,"onUpdate:blocks":o[1]||(o[1]=o=>e.dataModel.blocks=o),config:e.config,onOnSelected:e.onSelected},null,8,["blocks","config","onOnSelected"])])),_:1}),f(v,{block:e.currentBlock,"onUpdate:block":o[2]||(o[2]=o=>e.currentBlock=o),config:e.config,"data-model":e.dataModel},null,8,["block","config","data-model"])])),_:1})])),_:1})])),_:1})};var Go=s({name:"App",components:{VisualEditor:zo},setup(){const e=i({jsonData:{container:{height:500,width:800},blocks:JSON.parse(sessionStorage.getItem("blocks")||"[]")},formData:[],customProps:{}});return window.addEventListener("beforeunload",(()=>{sessionStorage.setItem("blocks",JSON.stringify(e.jsonData.blocks))})),a(a({},u(e)),{visualConfig:De})}});Go.render=function(e,o,t,l,n,a){const s=k("visual-editor");return p(),m(s,{modelValue:e.jsonData,"onUpdate:modelValue":o[1]||(o[1]=o=>e.jsonData=o),config:e.visualConfig,"form-data":e.formData,"custom-props":e.customProps},null,8,["modelValue","config","form-data","custom-props"])};const Ho=Ve({history:je(),routes:[]}),Jo={count:0};var Ko=Oe({state:()=>Jo,mutations:{increment(e){e.count++}},actions:{increment(e){e.commit("increment")}},getters:{double:e=>2*e.count}});const Xo=X(Go);Xo.config.globalProperties.$$refs={},window.$$refs=Xo.config.globalProperties.$$refs,Xo.use(Ho).use(Ko).mount("#app");
